//FATISDA MEDICAL CENTER
//Oleh Muhammad Haidar Amru
//Kelas A L0125025
#include <stdio.h>
#include <string.h>

void cekKondisi (int id[], char nama[][30], float suhu[], int n){
    if (n == 0 ){
        printf("\nBelum ada data pasien!\n");
        return;
    }

    int cariID, ketemu = 0;
    printf("\n=== Cek Kondisi Pasien Berdasarkan Suhu ===\n");
    printf("Masukkan ID Pasien: ");
    scanf("%d", &cariID);

    for (int i = 0; i < n; i++)
    {
        if (id[i] == cariID){
        ketemu = 1;
        printf ("\nNama : %s\n", nama[i]);
        printf ("Suhu %s : %.1f°C\n", nama[i], suhu[i]);
            
            if (suhu[i] < 36.0)
                printf("Kondisi %s : Suhu rendah (hipotermia ringan)\n", nama[i]);
            else if (suhu[i] <= 37.5)
                printf("Kondisi %s : Normal\n", nama[i]);
            else if (suhu[i] <= 38.5)
                printf("Kondisi %s : Demam ringan\n", nama[i]);
            else if (suhu[i] <= 40.0)
                printf("Kondisi %s : Demam tinggi\n", nama[i]);
            else
                printf("Kondisi %s Sangat tinggi, butuh penanganan segera!\n", nama[i]);
            
                return;
    }
}

        if (!ketemu)
        {
            printf("\nID pasien (%d) tidak ditemukan dalam database.\n", cariID);
        }
}


int main (){
    int pilMenu; 
    char pilUlang;
    int idPasien[100], umurPasien[100];
    int jmlPasien = 0;
    char namaPasien [100][30], jkPasien[100];
    float suhuPasien [100], tinggiPasien[100], beratPasien[100];

    printf ("============================\n");
    printf ("   FATISDA MEDICAL CENTER\n");
    printf ("============================\n");
    do
    {
        do {
        printf("\n1. Tambah Data Pasien");
        printf("\n2. Lihat Semua Data Pasien");
        printf("\n3. Cari Data Pasien Berdasarkan ID");
        printf("\n4. Hitung Berat Badan Ideal");
        printf("\n5. Cek Kondisi Pasien");
        printf("\n6. Keluar Program\n");

        printf("\n----------------------------");
        printf("\nPilih menu (1-6) : ");
        scanf("%d", &pilMenu);

        if (pilMenu < 1 || pilMenu > 6){
            printf ("\nPilihan tidak VALID, silahkan coba lagi\n");
            }
        
        } while (pilMenu < 1 || pilMenu > 6);

    switch (pilMenu) {
    case 1:
        if (jmlPasien >= 100)
        {
            printf ("Data penuh, tidak bisa menambah lagi");
        }
        else {
            printf("\n===Tambah Data Pasien===\n");
            printf ("Masukkan ID Pasien : ");
            scanf ("%d", &idPasien[jmlPasien]);
            printf ("Masukkan Nama Pasien : ");
            scanf (" %[^\n]", &namaPasien[jmlPasien]);
            
            do
            {
            printf ("Masukkan Jenis Kelamin Pasien (L/P) : ");
            scanf (" %c", &jkPasien[jmlPasien]);
                if (jkPasien[jmlPasien] != 'L' && jkPasien[jmlPasien] != 'l' 
                 && jkPasien[jmlPasien] != 'P' && jkPasien[jmlPasien] != 'p') {
            printf("Input tidak valid! Masukkan L atau P saja.\n");
    }
            } while (jkPasien[jmlPasien] != 'L' && jkPasien[jmlPasien] != 'l' &&
                     jkPasien[jmlPasien] != 'P' && jkPasien[jmlPasien] != 'p');
        
            printf ("Masukkan Umur Pasien : ");
            scanf ("%d", &umurPasien[jmlPasien]);
            printf ("Masukkan Suhu Pasien : ");
            scanf ("%f", &suhuPasien[jmlPasien]);
            printf ("Masukkan Tinggi Pasien : ");
            scanf ("%f", &tinggiPasien[jmlPasien]);
            printf ("Masukkan Berat Pasien : ");
            scanf ("%f", &beratPasien[jmlPasien]);
            
            jmlPasien++;

            printf("\nData pasien berhasil ditambahkan!\n");
        }
        break;
    case 2 :
    
    if (jmlPasien == 0)
    {
        printf("\nBelum ada data pasien yang tersimpan\n");
    }
    else {
            printf("\n===Lihat Semua Data Pasien===");
            printf("-------------------------------------------------------------\n");
            printf("| %-3s | | %-15s | | %-4s | | %-4s | | %-6s | | %-6s | | %-6s |\n",
                 "ID", "Nama", "JK", "Umur", "Suhu", "Tinggi", "Berat");
        }
        for (int i = 0; i < jmlPasien; i++)
        {
            printf("| %-3d | | %-15s | | %-4c | | %-4d | | %-6.1f°C | | %-6.1f | | %-6.1f |\n",
                    idPasien[i], namaPasien[i], jkPasien[i], umurPasien[i], suhuPasien[i], tinggiPasien[i], beratPasien[i]);
        }
        
            printf("-------------------------------------------------------------\n");
            printf("Jumlah pasien saat ini adalah : %d\n", jmlPasien);
        break;
    case 3 :
    if (jmlPasien ==0){
        printf("Belum ada data pasien yang tersimpan\n");
    }
    else {
        printf("\n===Cari Data Pasien Berdasarkan ID===\n");
        int cariID;
        int ketemu = 0;

        printf("Masukkan ID pasien yang ingin dicari : ");
        scanf("%d", &cariID);

        for (int i = 0; i < jmlPasien; i++)
        {
        if (idPasien[i] == cariID){
            printf("Data pasien ditemukan!\n");
            printf("-------------------------------------------------------------\n");
            printf("| %-3s | | %-15s | | %-4s | | %-4s | | %-6s | | %-6s | | %-6s |\n",
                 "ID", "Nama", "JK", "Umur", "Suhu", "Tinggi", "Berat");
        
            printf("| %-3d | | %-15s | | %-4c | | %-4d | | %-6.1f°C | | %-6.1f | | %-6.1f |\n",
                    idPasien[i], namaPasien[i], jkPasien[i], umurPasien[i], suhuPasien[i], tinggiPasien[i], beratPasien[i]);
            printf("-------------------------------------------------------------\n");
            ketemu = 1;
            break;
            }
        }
        if (!ketemu)
        {
            printf("\nID pasien (%d) tidak ditemukan dalam database.\n", cariID);
        }
        
    }
        break;

    case 4 : 
    if (jmlPasien ==0){
        printf("Belum ada data pasien yang tersimpan\n");
        break;
    }
    printf("\n===Hitung berat badan ideal pasien===\n");
    int cariID4, ketemu4 = 0;
    printf ("Masukkan ID pasien yang ingin dicek : ");
    scanf("%d", &cariID4);

    for (int i = 0; i < jmlPasien; i++)
    {
    if (idPasien[i] == cariID4)
    {
    ketemu4 = 1;
    float bbi;
    
        if (jkPasien[i] == 'l' || jkPasien[i] == 'L'){
            bbi = (tinggiPasien[i]-100) * 0.9;
        }
        else if (jkPasien[i] == 'p' || jkPasien[i] == 'P'){
            bbi = (tinggiPasien[i]-100) * 0.85;
        }
        else {
            printf("Jenis kelamin tidak valid!\n");
            return 0;
        }
        printf ("\nData Pasien : \n");
        printf("Nama   : %s\n", namaPasien[i]);
        printf("Tinggi : %.1f cm\n", tinggiPasien[i]);
        printf("Berat  : %.1f kg\n", beratPasien[i]);
        printf("BBI    : %.1f kg\n", bbi);

        if (beratPasien[i] > bbi + 5)
        {
            printf("Berat badan %s di atas ideal.\n", namaPasien[i]);
        }
        else if (beratPasien[i] < bbi - 5){
            printf("Berat badan %s di bawah ideal.\n",  namaPasien[i]);
        }
        else {
            printf ("Berat badan %s sudah ideal.",  namaPasien[i]);
        }
    }

        
    }
        if (!ketemu4)
        {
            printf("\nID pasien (%d) tidak ditemukan dalam database.\n", cariID4);
        }
        break; 
    case 5 : 
    cekKondisi(idPasien, namaPasien, suhuPasien, jmlPasien);
        break; 
    case 6 : 
    printf("\nTerima kasih telah menggunakan layanan FATISDA Medical Center!\n");
    return 0;
    default:
        break;
    }

    printf("\n----------------------------");
    printf("\nKembali ke menu utama? (y/n) : ");
    scanf(" %c", &pilUlang);

    } while (pilUlang == 'y' || pilUlang == 'Y');
    printf("\nTerima kasih telah menggunakan layanan FATISDA Medical Center!\n");
    
    return 0;

}
